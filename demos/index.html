<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyTab Venue Demos</title>
    <link rel="icon" type="image/png" href="../site/s4-center-icon.png">
    <link rel="apple-touch-icon" href="../site/s4-center-icon.png">
    <meta name="description" content="SkyTab Venue Demo Videos - Watch POS, Kiosk, and Wallet redemption flows in action.">

    <!-- Open Graph -->
    <meta property="og:title" content="SkyTab Venue Demos | Product Demo">
    <meta property="og:description" content="Watch SkyTab Venue demo videos for POS, Kiosk, and Wallet redemption flows.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="../site/stv.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SkyTab Venue Demos | Product Demo">
    <meta name="twitter:description" content="Demo videos for SkyTab Venue POS platform.">

    <!-- Resource Hints -->
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'shift4': {
                            'night-black': '#000000',
                            'sky-blue': '#136EF6',
                            'midnight-blue': '#102749',
                            'cool-grey': '#E7E7E7',
                            'stellar-white': '#FFFFFF',
                        }
                    },
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Shared CSS -->
    <link rel="stylesheet" href="../css/styles.css">

    <style>
        /* Custom scrollbar for tabs */
        .tabs-scroll::-webkit-scrollbar {
            height: 4px;
        }
        .tabs-scroll::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 2px;
        }
        .tabs-scroll::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
        }
        .tabs-scroll::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Rotating device carousel */
        .rotating-carousel {
            perspective: 1500px;
            perspective-origin: center center;
        }
        .rotating-device {
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }
        .rotating-device.front {
            transform: translateZ(0) rotateY(0deg) scale(1);
            opacity: 1;
            z-index: 10;
        }
        .rotating-device.back {
            transform: translateZ(-200px) rotateY(25deg) scale(0.7);
            opacity: 0.3;
            z-index: 1;
            filter: grayscale(0.5);
        }
        .rotating-device.back-left {
            transform: translateZ(-200px) rotateY(-25deg) scale(0.7);
        }
    </style>
</head>
<body class="bg-shift4-midnight-blue text-white">
    <a href="#demos-content" class="skip-to-content">Skip to main content</a>
    <div id="root"></div>

    <!-- Shared Data -->
    <script src="../js/data.js"></script>

    <!-- Shared Components (JSX - needs Babel) -->
    <script type="text/babel" src="../js/shared-components.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- DEMO CATEGORIES AND TABS CONFIGURATION ---
        const DEMO_CATEGORIES = [
            {
                id: 'wallet-mobile',
                label: 'Wallet & Mobile',
                icon: 'Wallet',
                color: 'orange',
                gradient: 'from-orange-500 to-amber-500',
            },
            {
                id: 'pos',
                label: 'POS',
                icon: 'Monitor',
                color: 'blue',
                gradient: 'from-blue-500 to-sky-500',
            },
            {
                id: 'back-of-house',
                label: 'Back of House',
                icon: 'LayoutGrid',
                color: 'violet',
                gradient: 'from-violet-500 to-purple-500',
            }
        ];

        const DEMO_TABS = {
            'pos': [
                {
                    id: 'fixed-pos',
                    label: 'Fixed POS',
                    icon: 'Monitor',
                    color: 'blue',
                    gradient: 'from-blue-500 to-sky-500',
                    stepColor: 'bg-[#136EF6]',
                    stepGlow: 'shadow-sky-500/50',
                    layout: 'device',
                    videoWidth: 1464,
                    videoHeight: 1046,
                    videoType: 'video/mp4',
                    description: 'Fixed POS',
                    flows: {
                        full: {
                            video: '../site/Fixed POS Demo.mov',
                            steps: [
                                // Quick Service Flow
                                { time: 0, label: 'Sign in with PIN or badge scan', category: 'Log In' },
                                { time: 12, label: 'Browse menu categories', category: 'Build Order' },
                                { time: 24, label: 'Add items to the cart', category: 'Build Order' },
                                { time: 50, label: 'Add Order Notes and Apply Discounts', category: 'Build Order' },
                                { time: 79, label: 'Select payment type', category: 'Take Payment' },
                                { time: 86, label: 'Guest selects tip and Round Up (optional)', category: 'Take Payment' },
                                { time: 98, label: 'Guest completes payment', category: 'Take Payment' },
                                { time: 104, label: 'Guest reviews order and selects receipt method', category: 'Order Review' },
                                // Premium In-Seat Service (Tabs) Flow
                                { time: 120, label: 'Switch revenue center', category: 'POS Configuration' },
                                { time: 145, label: 'Sign in to In-Seat Service', category: 'Tab Service' },
                                { time: 154, label: 'Add items to the cart', category: 'Tab Service' },
                                { time: 178, label: 'Select guest location (if applicable)', category: 'Tab Service' },
                                { time: 195, label: 'Start a tab', category: 'Tab Service' },
                                { time: 207, label: 'View and manage open tabs', category: 'Manage Tabs' },
                                { time: 224, label: 'Add items to an existing tab', category: 'Manage Tabs' },
                                { time: 245, label: 'Close tab and select payment type', category: 'Close Out' },
                                { time: 255, label: 'Guest selects tip and Round Up (optional)', category: 'Close Out' },
                                { time: 262, label: 'Guest completes payment', category: 'Close Out' },
                                { time: 266, label: 'Guest reviews order and selects receipt method', category: 'Close Out' },
                                { time: 278, label: 'Review closed orders and Sales Report', category: 'Close Out' }
                            ]
                        },
                        quick: {
                            video: '../site/Quick Service Demo.mov',
                            steps: [
                                { time: 0, label: 'Sign in with PIN or badge scan', category: 'Log In' },
                                { time: 12, label: 'Browse menu categories', category: 'Build Order' },
                                { time: 24, label: 'Add items to the cart', category: 'Build Order' },
                                { time: 50, label: 'Add Order Notes and Apply Discounts', category: 'Build Order' },
                                { time: 79, label: 'Select payment type', category: 'Take Payment' },
                                { time: 86, label: 'Guest selects tip and Round Up (optional)', category: 'Take Payment' },
                                { time: 98, label: 'Guest completes payment', category: 'Take Payment' },
                                { time: 104, label: 'Guest reviews order and selects receipt method', category: 'Order Review' }
                            ]
                        },
                        tabs: {
                            layout: 'rotating',
                            devices: [
                                {
                                    id: 'mobile',
                                    label: 'Handheld',
                                    video: '../site/Tabs Demo.mov',
                                    videoType: 'video/mp4',
                                    videoWidth: 496,
                                    videoHeight: 916,
                                    frame: 'device'
                                },
                                {
                                    id: 'fixed',
                                    label: 'Fixed POS',
                                    video: '../site/Fixed Tab Demo.mov',
                                    videoType: 'video/mp4',
                                    videoWidth: 1494,
                                    videoHeight: 1034,
                                    frame: 'pos'
                                }
                            ],
                            steps: [
                                // Video 1 - Mobile Handheld
                                { time: 0, label: 'Sign in with PIN or badge scan', category: 'Login', device: 'mobile' },
                                { time: 10, label: 'Build order', category: 'Ordering', device: 'mobile' },
                                { time: 20, label: 'Add location (Optional)', category: 'Tab Setup', device: 'mobile' },
                                { time: 36, label: 'Add order notes (Optional)', category: 'Tab Setup', device: 'mobile' },
                                { time: 53, label: 'Start a tab', category: 'Tab Creation', device: 'mobile' },
                                { time: 64, label: 'Name the tab', category: 'Tab Creation', device: 'mobile' },
                                { time: 80, label: 'Locate the tab', category: 'Tab Lookup', device: 'mobile' },
                                { time: 90, label: 'Add items to the tab', category: 'Ordering', device: 'mobile' },

                                // Video 2 - Fixed POS
                                { time: 0, label: 'Move to Fixed POS', category: 'Device Handoff', device: 'fixed' },
                                { time: 7, label: 'Locate open tab', category: 'Tab Lookup', device: 'fixed' },
                                { time: 15, label: 'Add a round to the tab', category: 'Ordering', device: 'fixed' },
                                { time: 40, label: 'Split the tab', category: 'Split Payments', device: 'fixed' },
                                { time: 90, label: 'Transfer the tab', category: 'Tab Management', device: 'fixed' },
                                { time: 122, label: 'Close the tab', category: 'Checkout', device: 'fixed' },
                                { time: 170, label: 'View tab in My Closed Orders', category: 'Order History', device: 'fixed' },
                                { time: 178, label: 'Reopen tab (As needed)', category: 'Manager Actions', device: 'fixed' },
                                { time: 191, label: 'Void items (As needed)', category: 'Manager Actions', device: 'fixed' },
                                { time: 207, label: 'Provide receipt or refund receipt (As needed)', category: 'Receipts', device: 'fixed' },
                                { time: 214, label: 'View sales report', category: 'Reporting', device: 'fixed' }
                            ]
                        }
                    }
                },
                {
                    id: 'mobile-pos',
                    label: 'Mobile POS',
                    icon: 'Smartphone',
                    color: 'blue',
                    gradient: 'from-sky-500 to-blue-600',
                    stepColor: 'bg-[#136EF6]',
                    stepGlow: 'shadow-sky-500/50',
                    layout: 'device',
                    videoWidth: 488,
                    videoHeight: 956,
                    video: '../site/Mobile POS Demo.mov',
                    videoType: 'video/mp4',
                    description: 'Mobile POS',
                    steps: [
                        { time: 0, label: 'Enter PIN or scan badge to sign in', category: 'Log In' },
                        { time: 13, label: 'Add items to the cart', category: 'Build Order' },
                        { time: 62, label: 'Review cart', category: 'Build Order' },
                        { time: 71, label: 'Add Order Notes', category: 'Build Order' },
                        { time: 82, label: 'Apply discounts or promos', category: 'Build Order' },
                        { time: 104, label: 'Choose payment type', category: 'Build Order' },
                        { time: 112, label: 'Hand device to guest for checkout', category: 'Take Payment' },
                        { time: 116, label: 'Guest selects tip', category: 'Take Payment' },
                        { time: 127, label: 'Guest selects Round Up (optional)', category: 'Take Payment' },
                        { time: 133, label: 'Guest taps, inserts, or swipes card', category: 'Take Payment' },
                        { time: 136, label: 'Guest confirms order total', category: 'Take Payment' },
                        { time: 143, label: 'Guest chooses receipt method', category: 'Take Payment' },
                        { time: 152, label: 'View completed orders in Orders', category: 'Close Out and Review' },
                        { time: 172, label: 'Review Sales Report', category: 'Close Out and Review' }
                    ]
                },
                {
                    id: 'kiosk',
                    label: 'Kiosk',
                    icon: 'Kiosk',
                    color: 'blue',
                    gradient: 'from-sky-500 to-blue-600',
                    stepColor: 'bg-[#136EF6]',
                    stepGlow: 'shadow-sky-500/50',
                    layout: 'device',
                    videoWidth: 822,
                    videoHeight: 1194,
                    video: '../site/Kiosk Demo.mov',
                    videoType: 'video/mp4',
                    description: 'Self-service Kiosk',
                    steps: [
                        { time: 0, label: 'Launch Kiosk', category: 'Start Order' },
                        { time: 5, label: 'Browse the menu', category: 'Build Order' },
                        { time: 16, label: 'Add items to cart', category: 'Build Order' },
                        { time: 56, label: 'Review cart and confirm total', category: 'Checkout' },
                        { time: 61, label: 'Select payment method', category: 'Payment' },
                        { time: 65, label: 'Choose tip amount', category: 'Payment' },
                        { time: 71, label: 'Add Round Up donation (optional)', category: 'Payment' },
                        { time: 77, label: 'Tap/insert/swipe card to pay', category: 'Payment' }
                    ]
                }
            ],
            'wallet-mobile': [
                {
                    id: 'mobile-ordering',
                    label: 'Mobile Ordering',
                    icon: 'Smartphone',
                    color: 'orange',
                    gradient: 'from-orange-500 to-amber-500',
                    stepColor: 'bg-orange-500',
                    stepGlow: 'shadow-orange-500/50',
                    layout: 'dual',
                    description: 'Mobile ordering with wallet benefits',
                    devices: [
                        {
                            type: 'iphone',
                            label: 'Mobile Ordering',
                            video: '../site/Mobile Ordering.MP4',
                            videoType: 'video/mp4'
                        },
                        {
                            type: 'ipad',
                            label: 'Xpedite',
                            video: '../site/Xpedite.mp4',
                            videoType: 'video/mp4'
                        }
                    ],
                    steps: [
                        // Ordering (iPhone video - 0:00 to ~1:20)
                        { time: 0, label: 'Browse Menus', category: 'Ordering', device: 'iphone' },
                        { time: 21, label: 'Add Items to Cart', category: 'Ordering', device: 'iphone' },
                        { time: 49, label: 'Checkout', category: 'Ordering', device: 'iphone' },
                        { time: 54, label: 'Review Order', category: 'Ordering', device: 'iphone' },
                        { time: 64, label: 'Place Order', category: 'Ordering', device: 'iphone' },
                        // Fulfillment (iPad video - ~28s total)
                        { time: 0, label: 'Order Received', category: 'Fulfillment', device: 'ipad' },
                        { time: 12, label: 'Prepare Order', category: 'Fulfillment', device: 'ipad' },
                        { time: 18, label: 'Mark Ready', category: 'Fulfillment', device: 'ipad' },
                        { time: 22, label: 'Hand Off to Guest', category: 'Fulfillment', device: 'ipad' },
                        { time: 28, label: 'Close Order', category: 'Fulfillment', device: 'ipad' }
                    ]
                },
                {
                    id: 'qr-pay',
                    label: 'QR Pay',
                    icon: 'CreditCard',
                    color: 'blue',
                    gradient: 'from-blue-500 to-sky-500',
                    stepColor: 'bg-blue-500',
                    stepGlow: 'shadow-blue-500/50',
                    video: '../site/POS-Wallet.mp4',
                    videoType: 'video/mp4',
                    layout: 'landscape',
                    description: 'POS terminal scanning wallet QR code',
                    steps: [
                        { time: 0, label: 'Ring Up Order' },
                        { time: 7, label: 'Tap QR Pay' },
                        { time: 17, label: 'Scan Pass' },
                        { time: 23, label: 'Complete' }
                    ]
                },
                {
                    id: 'mobile-wallet',
                    label: 'Mobile Wallet',
                    icon: 'Wallet',
                    color: 'emerald',
                    gradient: 'from-emerald-500 to-teal-500',
                    stepColor: 'bg-emerald-500',
                    stepGlow: 'shadow-emerald-500/50',
                    video: null,
                    videoType: 'video/mp4',
                    description: 'Apple & Google Wallet pass management',
                    steps: [
                        { time: 0, label: 'Add Pass' },
                        { time: 10, label: 'View Benefits' },
                        { time: 20, label: 'Use Pass' },
                        { time: 30, label: 'Track Rewards' }
                    ]
                }
            ],
            'back-of-house': [
                {
                    id: 'menu-manager',
                    label: 'Menu Manager',
                    icon: 'LayoutGrid',
                    color: 'violet',
                    gradient: 'from-violet-500 to-purple-500',
                    stepColor: 'bg-violet-500',
                    stepGlow: 'shadow-violet-500/50',
                    layout: 'browser',
                    video: '../site/Menu Manager Demo.mp4',
                    videoType: 'video/mp4',
                    description: 'Manage menus, items, and pricing across your venue',
                    steps: [
                        // Log In
                        { time: 0, label: 'Sign In', category: 'Log In' },

                        // Revenue Centers
                        { time: 5, label: 'Filter by Service Type', category: 'Revenue Centers' },
                        { time: 12, label: 'Search Revenue Center', category: 'Revenue Centers' },
                        { time: 19, label: 'Edit Revenue Center', category: 'Revenue Centers' },
                        { time: 39, label: 'Menus Settings', category: 'Revenue Centers' },
                        { time: 54, label: 'Menu Items', category: 'Revenue Centers' },
                        { time: 72, label: 'Revenue Center Settings', category: 'Revenue Centers' },

                        // Items
                        { time: 100, label: 'View Items', category: 'Items' },
                        { time: 108, label: 'Search Items', category: 'Items' },
                        { time: 121, label: 'Edit Item', category: 'Items' },
                        { time: 130, label: 'View Assigned Menus', category: 'Items' },
                        { time: 140, label: 'Pricing and Price Levels', category: 'Items' },
                        { time: 147, label: 'Taxes', category: 'Items' },
                        { time: 154, label: 'Item Settings', category: 'Items' },

                        // Configuration
                        { time: 170, label: 'Display Categories', category: 'Configuration' },
                        { time: 177, label: 'Reporting Categories', category: 'Configuration' },
                        { time: 182, label: 'Modifier Groups', category: 'Configuration' },
                        { time: 190, label: 'Sales Events', category: 'Configuration' },

                        // Orders App
                        { time: 203, label: 'View Orders', category: 'Orders App' },
                        { time: 208, label: 'Filter by Date Range', category: 'Orders App' },
                        { time: 218, label: 'Filter by Order Status', category: 'Orders App' },
                        { time: 223, label: 'Filter by Revenue Center', category: 'Orders App' },
                        { time: 229, label: 'Search Orders', category: 'Orders App' },
                        { time: 236, label: 'View Order Details', category: 'Orders App' },
                        { time: 253, label: 'Send Receipt', category: 'Orders App' },
                        { time: 264, label: 'Process Refund', category: 'Orders App' },

                        // Status App
                        { time: 286, label: 'Revenue Centers', category: 'Status App' },
                        { time: 296, label: 'Global Availability', category: 'Status App' },
                        { time: 312, label: 'Global Items', category: 'Status App' }
                    ]
                }
            ]
        };

        // Helper to get icon component
        const getIcon = (iconName, className = "w-5 h-5") => {
            const IconComponent = Icons[iconName];
            return IconComponent ? <IconComponent className={className} /> : null;
        };

        // --- DEMOS PAGE COMPONENT ---
        const DemosPage = () => {
            const [activeCategory, setActiveCategory] = useState('pos');
            const [activeTab, setActiveTab] = useState('fixed-pos');
            const [activeStep, setActiveStep] = useState(0);
            const [isPaused, setIsPaused] = useState(false);
            const [posFlow, setPosFlow] = useState('full'); // 'full' | 'quick' | 'tabs'
            const [activeDevice, setActiveDevice] = useState('iphone'); // Track which device is currently playing for emphasis
            const activeDeviceRef = useRef('iphone'); // Ref to track current device for closures
            const videoRef = useRef(null);
            const ipadVideoRef = useRef(null);

            // Refs for video sync state (accessible across functions)
            const ipadHasStartedRef = useRef(false);
            const iphoneIsPausedRef = useRef(false);
            const prevIphoneTimeRef = useRef(0); // Track previous time to detect loops

            // Get current category tabs
            const currentCategoryTabs = DEMO_TABS[activeCategory] || [];

            // Get current tab config
            const currentTab = currentCategoryTabs.find(t => t.id === activeTab);

            // Get current video and steps based on flow selection (for fixed-pos) - memoized to prevent re-renders
            const currentFlowData = useMemo(() => {
                if (activeTab === 'fixed-pos' && currentTab?.flows) {
                    const flow = currentTab.flows[posFlow] || currentTab.flows.full;
                    return {
                        video: flow.video,
                        steps: flow.steps,
                        layout: flow.layout,
                        devices: flow.devices
                    };
                }
                return {
                    video: currentTab?.video,
                    steps: currentTab?.steps || [],
                    layout: currentTab?.layout,
                    devices: currentTab?.devices
                };
            }, [activeTab, posFlow, currentTab]);

            // When category changes, select first tab in that category
            useEffect(() => {
                const tabs = DEMO_TABS[activeCategory];
                if (tabs && tabs.length > 0) {
                    setActiveTab(tabs[0].id);
                }
            }, [activeCategory]);

            // Sync steps with video timeline (for non-dual/non-rotating layouts)
            useEffect(() => {
                const video = videoRef.current;
                const hasVideo = currentFlowData.video || currentTab?.video;
                if (!video || !hasVideo || currentTab?.layout === 'dual' || currentFlowData.layout === 'rotating') return;

                const handleTimeUpdate = () => {
                    const time = video.currentTime;
                    const steps = currentFlowData.steps;

                    // Find the current step based on time
                    let currentStepIndex = 0;
                    for (let i = steps.length - 1; i >= 0; i--) {
                        if (time >= steps[i].time) {
                            currentStepIndex = i;
                            break;
                        }
                    }
                    setActiveStep(currentStepIndex);
                };

                video.addEventListener('timeupdate', handleTimeUpdate);
                return () => video.removeEventListener('timeupdate', handleTimeUpdate);
            }, [activeTab, posFlow]);

            // Reset step and video when tab changes
            useEffect(() => {
                setActiveStep(0);
                setPosFlow('full'); // Reset to full demo when switching tabs
                if (videoRef.current) {
                    videoRef.current.currentTime = 0;
                }
                // Reset iPad video to first frame and pause
                if (ipadVideoRef.current) {
                    ipadVideoRef.current.currentTime = 0;
                    ipadVideoRef.current.pause();
                }
            }, [activeTab]);

            /*
             * VIDEO SYNC LOGIC FOR ROTATING LAYOUT (Tabs flow)
             * --------------------------------------------------------
             * Sequential playback between Mobile Handheld and Fixed POS:
             *
             * Timeline:
             *   Mobile video plays (steps 0-1)
             *   Mobile ends → rotation animation triggers
             *   Fixed video plays (steps 2-12)
             *   Fixed ends → rotate back, loop from beginning
             */
            // Keep ref in sync with activeDevice state
            useEffect(() => {
                activeDeviceRef.current = activeDevice;
            }, [activeDevice]);

            useEffect(() => {
                const mobileVideo = videoRef.current;
                const fixedVideo = ipadVideoRef.current;

                // Check if we're in rotating layout
                if (currentFlowData.layout !== 'rotating' || !mobileVideo || !fixedVideo) return;

                const mobileSteps = currentFlowData.steps.filter(s => s.device === 'mobile');
                const fixedSteps = currentFlowData.steps.filter(s => s.device === 'fixed');

                const handleMobileTimeUpdate = () => {
                    if (activeDeviceRef.current !== 'mobile') return;
                    const time = mobileVideo.currentTime;

                    // Update step for mobile phase
                    for (let i = mobileSteps.length - 1; i >= 0; i--) {
                        if (time >= mobileSteps[i].time) {
                            setActiveStep(i);
                            break;
                        }
                    }
                };

                const handleMobileEnded = () => {
                    // Mobile video finished, switch to fixed
                    setActiveDevice('fixed');
                    activeDeviceRef.current = 'fixed';
                    setActiveStep(mobileSteps.length); // First fixed step
                    fixedVideo.currentTime = 0;
                    fixedVideo.play();
                };

                const handleFixedTimeUpdate = () => {
                    if (activeDeviceRef.current !== 'fixed') return;
                    const time = fixedVideo.currentTime;

                    // Update step for fixed phase (offset by mobile steps count)
                    for (let i = fixedSteps.length - 1; i >= 0; i--) {
                        if (time >= fixedSteps[i].time) {
                            setActiveStep(mobileSteps.length + i);
                            break;
                        }
                    }
                };

                const handleFixedEnded = () => {
                    // Fixed video finished, loop back to mobile
                    setActiveDevice('mobile');
                    activeDeviceRef.current = 'mobile';
                    setActiveStep(0);
                    fixedVideo.currentTime = 0;
                    fixedVideo.pause();
                    mobileVideo.currentTime = 0;
                    mobileVideo.play();
                };

                mobileVideo.addEventListener('timeupdate', handleMobileTimeUpdate);
                mobileVideo.addEventListener('ended', handleMobileEnded);
                fixedVideo.addEventListener('timeupdate', handleFixedTimeUpdate);
                fixedVideo.addEventListener('ended', handleFixedEnded);

                // Initialize: mobile plays first, fixed paused
                setActiveDevice('mobile');
                activeDeviceRef.current = 'mobile';
                fixedVideo.currentTime = 0;
                fixedVideo.pause();

                return () => {
                    mobileVideo.removeEventListener('timeupdate', handleMobileTimeUpdate);
                    mobileVideo.removeEventListener('ended', handleMobileEnded);
                    fixedVideo.removeEventListener('timeupdate', handleFixedTimeUpdate);
                    fixedVideo.removeEventListener('ended', handleFixedEnded);
                };
            }, [activeTab, posFlow]);

            /*
             * VIDEO SYNC LOGIC FOR DUAL LAYOUT (Mobile Ordering tab)
             * --------------------------------------------------------
             * This creates a synchronized playback experience between iPhone and iPad:
             *
             * Timeline:
             *   0:00 - 1:08  →  iPhone plays (steps 0-4: Ordering), iPad paused
             *   1:08         →  iPad starts playing, step jumps to 5 (Fulfillment)
             *   1:10         →  iPhone pauses and waits
             *   iPad plays   →  Steps 5-9 sync with iPad video timestamps
             *   iPad ends    →  Everything resets, cycle restarts from step 0
             *
             * Steps 0-4 (Ordering) sync with iPhone video
             * Steps 5-9 (Fulfillment) sync with iPad video
             */
            useEffect(() => {
                const iphoneVideo = videoRef.current;
                const ipadVideo = ipadVideoRef.current;
                if (!iphoneVideo || !ipadVideo || currentTab?.layout !== 'dual') return;

                const IPAD_TRIGGER_TIME = 68; // 1:08 - iPad starts (3s longer on Place Order)
                const IPHONE_PAUSE_TIME = 70; // 1:10 - iPhone pauses

                // Get ordering steps (iPhone) and fulfillment steps (iPad)
                const orderingSteps = currentTab.steps.filter(s => s.device === 'iphone');
                const fulfillmentSteps = currentTab.steps.filter(s => s.device === 'ipad');

                const handleIphoneTimeUpdate = () => {
                    const time = iphoneVideo.currentTime;
                    const prevTime = prevIphoneTimeRef.current;
                    prevIphoneTimeRef.current = time;

                    // Update step for Ordering phase (steps 0-4)
                    if (!ipadHasStartedRef.current) {
                        for (let i = orderingSteps.length - 1; i >= 0; i--) {
                            if (time >= orderingSteps[i].time) {
                                setActiveStep(i);
                                break;
                            }
                        }
                    }

                    // Start iPad when iPhone hits 1:08 (auto-play only, not manual navigation)
                    if (time >= IPAD_TRIGGER_TIME && !ipadHasStartedRef.current) {
                        ipadHasStartedRef.current = true;
                        ipadVideo.currentTime = 0;
                        ipadVideo.play();
                        setActiveStep(5); // Jump to first Fulfillment step
                        setActiveDevice('ipad'); // Emphasize iPad
                    }

                    // Pause iPhone at 1:10 while iPad plays
                    if (time >= IPHONE_PAUSE_TIME && !iphoneIsPausedRef.current && ipadHasStartedRef.current) {
                        iphoneIsPausedRef.current = true;
                        iphoneVideo.pause();
                    }

                    // Reset flags only when iPhone actually loops (jumps from high time to low time)
                    // This prevents resetting when manually navigating to iPad steps
                    const hasLooped = prevTime > 60 && time < 5;
                    if (hasLooped) {
                        ipadHasStartedRef.current = false;
                        iphoneIsPausedRef.current = false;
                        setActiveStep(0);
                        setActiveDevice('iphone'); // Emphasize iPhone
                    }
                };

                const handleIpadTimeUpdate = () => {
                    if (!ipadHasStartedRef.current) return;
                    const time = ipadVideo.currentTime;

                    // Update step for Fulfillment phase (steps 5-9)
                    for (let i = fulfillmentSteps.length - 1; i >= 0; i--) {
                        if (time >= fulfillmentSteps[i].time) {
                            setActiveStep(5 + i); // Offset by 5 for fulfillment steps
                            break;
                        }
                    }
                };

                const handleIpadEnded = () => {
                    // When iPad finishes, restart the entire cycle from the beginning
                    // Reset iPad
                    ipadVideo.currentTime = 0;
                    ipadVideo.pause();

                    // Reset iPhone to start
                    iphoneVideo.currentTime = 0;
                    iphoneVideo.play();

                    // Reset all flags and step
                    ipadHasStartedRef.current = false;
                    iphoneIsPausedRef.current = false;
                    setActiveStep(0);
                    setActiveDevice('iphone'); // Emphasize iPhone
                };

                iphoneVideo.addEventListener('timeupdate', handleIphoneTimeUpdate);
                ipadVideo.addEventListener('timeupdate', handleIpadTimeUpdate);
                ipadVideo.addEventListener('ended', handleIpadEnded);

                // Initialize iPad paused at first frame and reset flags
                ipadVideo.currentTime = 0;
                ipadVideo.pause();
                ipadHasStartedRef.current = false;
                iphoneIsPausedRef.current = false;
                setActiveDevice('iphone'); // Start with iPhone emphasized

                return () => {
                    iphoneVideo.removeEventListener('timeupdate', handleIphoneTimeUpdate);
                    ipadVideo.removeEventListener('timeupdate', handleIpadTimeUpdate);
                    ipadVideo.removeEventListener('ended', handleIpadEnded);
                };
            }, [activeTab, currentTab]);

            // Seek video to step time
            const seekToStep = (stepIndex) => {
                if (videoRef.current && currentTab?.steps[stepIndex]) {
                    videoRef.current.currentTime = currentTab.steps[stepIndex].time;
                    setActiveStep(stepIndex);
                }
            };

            // Toggle pause/play for all videos
            const togglePause = () => {
                const iphoneVideo = videoRef.current;
                const ipadVideo = ipadVideoRef.current;

                // Handle browser layout (single video)
                if (currentTab?.layout === 'browser') {
                    if (iphoneVideo) {
                        if (isPaused) {
                            iphoneVideo.play();
                        } else {
                            iphoneVideo.pause();
                        }
                    }
                    setIsPaused(!isPaused);
                    return;
                }

                // Handle portrait layout (single video)
                if (currentTab?.layout === 'portrait') {
                    if (iphoneVideo) {
                        if (isPaused) {
                            iphoneVideo.play();
                        } else {
                            iphoneVideo.pause();
                        }
                    }
                    setIsPaused(!isPaused);
                    return;
                }

                // Handle rotating layout (mobile + fixed sequential) - check BEFORE device layout
                if (currentFlowData.layout === 'rotating') {
                    if (isPaused) {
                        // Resume the active device's video
                        if (activeDevice === 'mobile') {
                            if (iphoneVideo) iphoneVideo.play();
                        } else {
                            if (ipadVideo) ipadVideo.play();
                        }
                    } else {
                        // Pause both videos
                        if (iphoneVideo) iphoneVideo.pause();
                        if (ipadVideo) ipadVideo.pause();
                    }
                    setIsPaused(!isPaused);
                    return;
                }

                // Handle device layout (single video)
                if (currentTab?.layout === 'device') {
                    if (iphoneVideo) {
                        if (isPaused) {
                            iphoneVideo.play();
                        } else {
                            iphoneVideo.pause();
                        }
                    }
                    setIsPaused(!isPaused);
                    return;
                }

                if (isPaused) {
                    // Resume - use refs to determine which video should play
                    if (ipadHasStartedRef.current) {
                        // We're in Fulfillment phase - resume iPad
                        if (ipadVideo && !ipadVideo.ended) {
                            ipadVideo.play();
                        }
                    } else {
                        // We're in Ordering phase - resume iPhone
                        if (iphoneVideo) {
                            iphoneVideo.play();
                        }
                    }
                } else {
                    // Pause all videos
                    if (iphoneVideo) iphoneVideo.pause();
                    if (ipadVideo) ipadVideo.pause();
                }
                setIsPaused(!isPaused);
            };

            // Navigate to previous/next step
            const goToStep = (stepIndex) => {
                const steps = currentFlowData.steps;
                if (!steps || stepIndex < 0 || stepIndex >= steps.length) return;

                const iphoneVideo = videoRef.current;
                const ipadVideo = ipadVideoRef.current;
                const step = steps[stepIndex];

                // Handle browser layout (single video, no device property)
                if (currentTab.layout === 'browser') {
                    if (iphoneVideo && currentTab.video) {
                        iphoneVideo.currentTime = step.time;
                        if (!isPaused) iphoneVideo.play();
                    }
                    setActiveStep(stepIndex);
                    return;
                }

                // Handle portrait layout (single video, no device property)
                if (currentTab.layout === 'portrait') {
                    if (iphoneVideo && currentTab.video) {
                        iphoneVideo.currentTime = step.time;
                        if (!isPaused) iphoneVideo.play();
                    }
                    setActiveStep(stepIndex);
                    return;
                }

                // Handle rotating layout (mobile + fixed sequential) - check BEFORE device layout
                if (currentFlowData.layout === 'rotating') {
                    if (step.device === 'mobile') {
                        setActiveDevice('mobile');
                        activeDeviceRef.current = 'mobile';
                        if (iphoneVideo) {
                            iphoneVideo.currentTime = step.time;
                            iphoneVideo.play();
                        }
                        if (ipadVideo) {
                            ipadVideo.pause();
                        }
                    } else if (step.device === 'fixed') {
                        setActiveDevice('fixed');
                        activeDeviceRef.current = 'fixed';
                        if (ipadVideo) {
                            ipadVideo.currentTime = step.time;
                            ipadVideo.play();
                        }
                        if (iphoneVideo) {
                            iphoneVideo.pause();
                        }
                    }
                    setActiveStep(stepIndex);
                    setIsPaused(false);
                    return;
                }

                // Handle device layout (single video, no device property)
                if (currentTab.layout === 'device') {
                    if (iphoneVideo && currentFlowData.video) {
                        iphoneVideo.currentTime = step.time;
                        iphoneVideo.play();
                    }
                    setActiveStep(stepIndex);
                    setIsPaused(false);
                    return;
                }

                // Determine which video to seek based on step's device (for dual layout)
                if (step.device === 'iphone') {
                    // Navigating to Ordering step - reset refs to initial state
                    ipadHasStartedRef.current = false;
                    iphoneIsPausedRef.current = false;
                    setActiveDevice('iphone'); // Emphasize iPhone

                    if (iphoneVideo) {
                        iphoneVideo.currentTime = step.time;
                        if (!isPaused) iphoneVideo.play();
                    }
                    if (ipadVideo) {
                        ipadVideo.currentTime = 0;
                        ipadVideo.pause();
                    }
                } else if (step.device === 'ipad') {
                    // Navigating to Fulfillment step - set iPad as started
                    ipadHasStartedRef.current = true;
                    iphoneIsPausedRef.current = true;
                    setActiveDevice('ipad'); // Emphasize iPad

                    if (ipadVideo) {
                        ipadVideo.currentTime = step.time;
                        if (!isPaused) ipadVideo.play();
                    }
                    if (iphoneVideo) {
                        // Seek iPhone to end of Ordering phase (where it pauses at 1:10)
                        iphoneVideo.currentTime = 70;
                        iphoneVideo.pause();
                    }
                }

                setActiveStep(stepIndex);
            };

            const goToPrevStep = () => goToStep(activeStep - 1);
            const goToNextStep = () => {
                const steps = currentFlowData.steps;
                if (activeStep < steps.length - 1) {
                    goToStep(activeStep + 1);
                }
            };

            return (
                <div className="min-h-screen flex flex-col bg-gradient-to-br from-shift4-midnight-blue via-slate-900 to-shift4-night-black">
                    {/* Header with Navigation */}
                    <header className="flex-shrink-0 border-b border-white/10 bg-black/30 backdrop-blur-xl">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between h-14">
                                {/* Back Link */}
                                <a
                                    href="../index.html"
                                    className="flex items-center gap-2 text-slate-400 hover:text-white transition-colors group flex-shrink-0"
                                >
                                    <svg className="w-4 h-4 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                    </svg>
                                    <span className="text-sm font-medium hidden sm:inline">Back</span>
                                </a>

                                {/* Navigation - Categories with Inline Sub-tabs */}
                                <div className="flex items-center gap-1">
                                    {DEMO_CATEGORIES.map((category, catIndex) => {
                                        const isActive = activeCategory === category.id;
                                        const categoryTabs = DEMO_TABS[category.id] || [];

                                        return (
                                            <React.Fragment key={category.id}>
                                                {/* Separator */}
                                                {catIndex > 0 && (
                                                    <div className="w-px h-6 bg-white/10 mx-1 hidden sm:block"></div>
                                                )}

                                                {/* Category Button */}
                                                <button
                                                    onClick={() => setActiveCategory(category.id)}
                                                    className={`
                                                        flex items-center gap-1.5 px-2 sm:px-3 py-1.5 rounded-md font-medium text-xs sm:text-sm
                                                        transition-all duration-200 whitespace-nowrap outline-none
                                                        ${isActive
                                                            ? 'text-white'
                                                            : 'text-slate-400 hover:text-white hover:bg-white/5'
                                                        }
                                                    `}
                                                >
                                                    <div className={`
                                                        p-1 rounded transition-all duration-200
                                                        ${isActive
                                                            ? `bg-gradient-to-br ${category.gradient}`
                                                            : 'bg-white/10'
                                                        }
                                                    `}>
                                                        {getIcon(category.icon)}
                                                    </div>
                                                    <span className="hidden sm:inline">{category.label}</span>
                                                </button>

                                                {/* Inline Sub-tabs (segmented control) */}
                                                {isActive && categoryTabs.length > 1 && (
                                                    <div className="flex items-center bg-white/5 rounded-md p-0.5 ml-1">
                                                        {categoryTabs.map((tab) => (
                                                            <button
                                                                key={tab.id}
                                                                onClick={() => setActiveTab(tab.id)}
                                                                className={`
                                                                    px-2 sm:px-3 py-1 rounded text-xs font-medium
                                                                    transition-all duration-150 outline-none whitespace-nowrap
                                                                    ${activeTab === tab.id
                                                                        ? 'bg-white/15 text-white'
                                                                        : 'text-slate-400 hover:text-white'
                                                                    }
                                                                `}
                                                            >
                                                                {tab.label}
                                                            </button>
                                                        ))}
                                                    </div>
                                                )}
                                            </React.Fragment>
                                        );
                                    })}
                                </div>

                                {/* Logo */}
                                <img
                                    src="../site/Shift4 Logo - RBG.png"
                                    alt="Shift4"
                                    className="h-5 opacity-90 hover:opacity-100 transition-opacity flex-shrink-0"
                                />
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main id="demos-content" className="flex-1 flex flex-col relative">
                        {/* Flow Toggle for Fixed POS - top left corner */}
                        {activeTab === 'fixed-pos' && (
                            <div className="absolute top-4 left-4 z-20">
                                <div className="flex items-center bg-slate-800/90 backdrop-blur-sm rounded-lg p-1 border border-slate-700/50">
                                    {[
                                        { id: 'full', label: 'Full Demo' },
                                        { id: 'quick', label: 'Quick Service' },
                                        { id: 'tabs', label: 'Tabs' }
                                    ].map((flow) => (
                                        <button
                                            key={flow.id}
                                            onClick={() => {
                                                setPosFlow(flow.id);
                                                setActiveStep(0);
                                                if (videoRef.current) {
                                                    videoRef.current.currentTime = 0;
                                                }
                                            }}
                                            className={`
                                                px-3 py-1.5 rounded-md text-xs font-medium
                                                transition-all duration-150
                                                ${posFlow === flow.id
                                                    ? 'bg-[#136EF6] text-white shadow-lg'
                                                    : 'text-slate-400 hover:text-white hover:bg-slate-700/50'
                                                }
                                            `}
                                        >
                                            {flow.label}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Steps Timeline - Carousel for dual layout, standard for others */}
                        <div className="flex-shrink-0">
                            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4 pb-2">
                                {(currentTab?.layout === 'dual' || currentTab?.layout === 'browser' || currentTab?.layout === 'portrait' || currentTab?.layout === 'device' || currentFlowData.layout === 'rotating') ? (
                                    /* Rotating Carousel for Dual/Browser/Rotating Layout */
                                    <div className="flex flex-col items-center">
                                        {/* Category Label */}
                                        <div className="mb-3 h-5 relative">
                                            <span className="text-xs font-semibold uppercase tracking-widest text-sky-400">
                                                {currentFlowData.steps[activeStep]?.category}
                                            </span>
                                        </div>

                                        {/* Carousel Container */}
                                        <div className="relative w-full max-w-3xl overflow-hidden h-14">

                                            {/* Carousel Track */}
                                            <div
                                                className="absolute top-1/2 flex items-center transition-transform duration-500 ease-out"
                                                style={{
                                                    left: '50%',
                                                    transform: `translateY(-50%) translateX(calc(-${activeStep * 340}px - 170px))`
                                                }}
                                            >
                                                {currentFlowData.steps.map((step, index) => {
                                                    const isActive = index === activeStep;
                                                    const isAdjacent = Math.abs(index - activeStep) === 1;

                                                    return (
                                                        <div
                                                            key={index}
                                                            onClick={() => goToStep(index)}
                                                            className="flex-shrink-0 w-[340px] flex items-center justify-center transition-all duration-500 ease-out cursor-pointer"
                                                            style={{
                                                                opacity: isActive ? 1 : isAdjacent ? 0.5 : 0.15,
                                                                transform: `scale(${isActive ? 1 : 0.85})`,
                                                            }}
                                                        >
                                                            <div
                                                                className={`
                                                                    flex items-center gap-3 px-5 py-2.5 rounded-full h-10
                                                                    transition-all duration-500
                                                                    ${isActive
                                                                        ? 'bg-[#136EF6] text-white'
                                                                        : 'bg-slate-800/80 border border-slate-700/50'
                                                                    }
                                                                `}
                                                            >
                                                                                                                                <span className={`
                                                                    text-sm font-semibold whitespace-nowrap
                                                                    ${isActive ? 'text-white' : 'text-slate-400'}
                                                                `}>
                                                                    {step.label}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        </div>

                                        {/* Progress Dots */}
                                        <div className="flex items-center gap-1.5 mt-3">
                                            {currentFlowData.steps.map((step, index) => (
                                                <div
                                                    key={index}
                                                    onClick={() => goToStep(index)}
                                                    className={`
                                                        h-1.5 rounded-full transition-all duration-300 cursor-pointer hover:opacity-80
                                                        ${index === activeStep
                                                            ? 'w-5 bg-[#136EF6]'
                                                            : index < activeStep
                                                                ? 'w-1.5 bg-[#136EF6]/50'
                                                                : 'w-1.5 bg-slate-600'
                                                        }
                                                    `}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                ) : (
                                    /* Standard Timeline for Other Layouts */
                                    <div className="flex items-center justify-center gap-2 md:gap-4 flex-wrap">
                                        {currentTab?.steps.map((step, index) => (
                                            <React.Fragment key={index}>
                                                <button
                                                    onClick={() => seekToStep(index)}
                                                    className={`flex items-center gap-2 transition-all duration-300 cursor-pointer hover:scale-105 ${
                                                        activeStep === index ? 'scale-110' : 'opacity-50 hover:opacity-80'
                                                    }`}
                                                >
                                                    <div className={`
                                                        w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold
                                                        transition-all duration-300
                                                        ${activeStep === index
                                                            ? `${currentTab.stepColor} text-white shadow-lg ${currentTab.stepGlow}`
                                                            : `${currentTab.stepColor}/20 text-white/70`
                                                        }
                                                    `}>
                                                        {index + 1}
                                                    </div>
                                                    <span className={`text-sm font-semibold transition-all duration-300 hidden sm:inline ${
                                                        activeStep === index ? 'text-white' : 'text-slate-400'
                                                    }`}>
                                                        {step.label}
                                                    </span>
                                                </button>
                                                {index < currentTab.steps.length - 1 && (
                                                    <svg
                                                        className={`w-4 h-4 transition-colors duration-300 hidden sm:block ${
                                                            activeStep > index ? currentTab.stepColor.replace('bg-', 'text-') : 'text-slate-600'
                                                        }`}
                                                        fill="none"
                                                        viewBox="0 0 24 24"
                                                        stroke="currentColor"
                                                    >
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                    </svg>
                                                )}
                                            </React.Fragment>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Video Area */}
                        <div className="flex-1 flex items-center justify-center p-4 sm:p-6 lg:p-8 relative">
                            {/* Playback Controls */}
                            {(currentTab?.layout === 'dual' || currentTab?.layout === 'browser' || currentTab?.layout === 'portrait' || currentTab?.layout === 'device' || currentFlowData.layout === 'rotating') && (
                                <div className="absolute bottom-4 left-4 z-20 flex items-center gap-2">
                                    {/* Previous Step */}
                                    <button
                                        onClick={goToPrevStep}
                                        disabled={activeStep === 0}
                                        className={`w-10 h-10 rounded-full bg-slate-800/80 hover:bg-slate-700/80 border border-slate-600/50 flex items-center justify-center transition-all duration-200 ${activeStep === 0 ? 'opacity-30 cursor-not-allowed' : 'hover:scale-110'}`}
                                        title="Previous Step"
                                    >
                                        <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                        </svg>
                                    </button>

                                    {/* Pause/Play */}
                                    <button
                                        onClick={togglePause}
                                        className="w-10 h-10 rounded-full bg-slate-800/80 hover:bg-slate-700/80 border border-slate-600/50 flex items-center justify-center transition-all duration-200 hover:scale-110"
                                        title={isPaused ? 'Play' : 'Pause'}
                                    >
                                        {isPaused ? (
                                            <svg className="w-4 h-4 text-white ml-0.5" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M8 5v14l11-7z"/>
                                            </svg>
                                        ) : (
                                            <svg className="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                                            </svg>
                                        )}
                                    </button>

                                    {/* Next Step */}
                                    <button
                                        onClick={goToNextStep}
                                        disabled={activeStep === (currentFlowData.steps?.length || 1) - 1}
                                        className={`w-10 h-10 rounded-full bg-slate-800/80 hover:bg-slate-700/80 border border-slate-600/50 flex items-center justify-center transition-all duration-200 ${activeStep === (currentFlowData.steps?.length || 1) - 1 ? 'opacity-30 cursor-not-allowed' : 'hover:scale-110'}`}
                                        title="Next Step"
                                    >
                                        <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                        </svg>
                                    </button>
                                </div>
                            )}
                            <div className="w-full max-w-6xl">
                                {currentTab?.layout === 'browser' ? (
                                    /* Browser Frame with Video */
                                    <div className="flex flex-col items-center w-full">
                                        <div className="relative w-full max-w-4xl">
                                            {/* Glow Effect */}
                                            <div className="absolute -inset-4 bg-[#136EF6] rounded-2xl blur-2xl opacity-20"></div>

                                            {/* Mac Window Frame */}
                                            <div className="relative rounded-xl overflow-hidden shadow-2xl border border-slate-700/50 bg-slate-900">
                                                {/* Browser Chrome */}
                                                <div className="bg-slate-800 px-4 py-3 flex items-center gap-3 border-b border-slate-700/50">
                                                    <div className="flex gap-1.5">
                                                        <div className="w-3 h-3 rounded-full bg-red-500/80"></div>
                                                        <div className="w-3 h-3 rounded-full bg-yellow-500/80"></div>
                                                        <div className="w-3 h-3 rounded-full bg-green-500/80"></div>
                                                    </div>
                                                    <div className="bg-slate-700/50 rounded-md px-4 py-1 text-xs text-slate-400">
                                                        venue-menu.ordernext.com
                                                    </div>
                                                </div>

                                                {/* Video Area */}
                                                <div className="aspect-[752/499] bg-slate-900 relative overflow-hidden">
                                                    {currentTab.video ? (
                                                        <video
                                                            ref={videoRef}
                                                            key={currentTab.id}
                                                            autoPlay
                                                            muted
                                                            loop
                                                            playsInline
                                                            className="w-full h-full object-cover"
                                                        >
                                                            <source src={currentTab.video} type={currentTab.videoType} />
                                                        </video>
                                                    ) : (
                                                        /* Placeholder when no video */
                                                        <div className="absolute inset-0 flex items-center justify-center bg-gradient-to-br from-slate-800 to-slate-900">
                                                            <div className="text-center">
                                                                <div className="w-20 h-20 rounded-2xl bg-[#136EF6]/20 flex items-center justify-center mx-auto mb-4">
                                                                    {getIcon('LayoutGrid', 'w-10 h-10 text-sky-400')}
                                                                </div>
                                                                <h3 className="text-white font-semibold mb-2">Menu Manager Demo</h3>
                                                                <p className="text-slate-400 text-sm">Video coming soon</p>
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ) : (currentTab?.video || currentTab?.devices || currentTab?.flows) ? (
                                    <div className="flex flex-col items-center">
                                        {currentTab.layout === 'dual' ? (
                                            /* Dual: iPhone + iPad side by side */
                                            <div className="flex items-center justify-center gap-8 lg:gap-16">
                                                {currentTab.devices.map((device, idx) => (
                                                    <div key={device.type} className="flex flex-col items-center">
                                                        {device.type === 'iphone' ? (
                                                            /* iPhone Frame */
                                                            <div className={`relative transition-all duration-500 ${activeDevice === 'iphone' ? 'scale-100 opacity-100' : 'scale-95 opacity-50 grayscale'}`}>
                                                                <div className={`absolute -inset-4 bg-[#136EF6] rounded-[3rem] blur-2xl transition-opacity duration-500 ${activeDevice === 'iphone' ? 'opacity-60' : 'opacity-0'}`}></div>
                                                                <div className="relative bg-black rounded-[2.5rem] border-[6px] border-slate-800 shadow-2xl overflow-hidden p-0.5 w-56 h-[484px] lg:w-64 lg:h-[554px]">
                                                                    <div className="absolute top-2 left-1/2 -translate-x-1/2 w-16 h-5 bg-black rounded-full z-10"></div>
                                                                    <div className="w-full h-full rounded-[2rem] overflow-hidden bg-black">
                                                                        <video
                                                                            ref={videoRef}
                                                                            key={device.type}
                                                                            autoPlay
                                                                            muted
                                                                            loop
                                                                            playsInline
                                                                            className="w-full h-full object-cover"
                                                                        >
                                                                            <source src={device.video} type={device.videoType} />
                                                                        </video>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            /* iPad Frame - Landscape */
                                                            <div className={`relative transition-all duration-500 ${activeDevice === 'ipad' ? 'scale-100 opacity-100' : 'scale-95 opacity-50 grayscale'}`}>
                                                                <div className={`absolute -inset-4 bg-[#136EF6] rounded-[2rem] blur-2xl transition-opacity duration-500 ${activeDevice === 'ipad' ? 'opacity-60' : 'opacity-0'}`}></div>
                                                                <div className="relative bg-black rounded-[1.5rem] border-[6px] border-slate-800 shadow-2xl overflow-hidden p-0.5 w-[532px] h-[374px] lg:w-[638px] lg:h-[440px]">
                                                                    <div className="w-full h-full rounded-[1rem] overflow-hidden bg-black">
                                                                        <video
                                                                            ref={ipadVideoRef}
                                                                            key={device.type}
                                                                            muted
                                                                            playsInline
                                                                            className="w-full h-full object-cover"
                                                                        >
                                                                            <source src={device.video} type={device.videoType} />
                                                                        </video>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        )}
                                                        <p className="text-slate-400 text-sm mt-3 font-medium">{device.label}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : currentFlowData.layout === 'rotating' ? (
                                            /* Rotating: Mobile Handheld + Fixed POS with 3D rotation */
                                            <div className="rotating-carousel relative w-full flex items-center justify-center" style={{ minHeight: '70vh' }}>
                                                {currentFlowData.devices.map((device) => {
                                                    const isActive = activeDevice === device.id;
                                                    const isMobile = device.id === 'mobile';

                                                    return (
                                                        <div
                                                            key={device.id}
                                                            className={`rotating-device absolute ${isActive ? 'front' : isMobile ? 'back-left' : 'back'}`}
                                                        >
                                                            <div className="flex flex-col items-center">
                                                                {/* Glow effect */}
                                                                <div className={`absolute -inset-4 bg-[#136EF6] rounded-[2rem] blur-2xl transition-opacity duration-500 ${isActive ? 'opacity-20' : 'opacity-0'}`}></div>

                                                                {/* Device Frame - same sizing as regular device layout */}
                                                                <div
                                                                    className="relative bg-slate-900 rounded-[1.5rem] border-[6px] border-slate-700 shadow-2xl overflow-hidden"
                                                                    style={{
                                                                        maxHeight: '70vh',
                                                                        aspectRatio: `${device.videoWidth} / ${device.videoHeight}`
                                                                    }}
                                                                >
                                                                    <video
                                                                        ref={isMobile ? videoRef : ipadVideoRef}
                                                                        key={`${device.id}-video`}
                                                                        autoPlay={isMobile}
                                                                        muted
                                                                        playsInline
                                                                        className="w-full h-full object-cover"
                                                                    >
                                                                        <source src={device.video} type={device.videoType} />
                                                                    </video>
                                                                </div>

                                                                {/* Label */}
                                                                <p className={`text-sm mt-3 font-medium transition-opacity duration-500 ${isActive ? 'text-slate-300' : 'text-slate-600'}`}>
                                                                    {device.label}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        ) : currentTab.layout === 'device' ? (
                                            /* Device: Generic device frame preserving video aspect ratio */
                                            <div className="relative flex flex-col items-center">
                                                <div className="absolute -inset-4 bg-[#136EF6] rounded-[2rem] blur-2xl opacity-20"></div>
                                                <div
                                                    className="relative bg-slate-900 rounded-[1.5rem] border-[6px] border-slate-700 shadow-2xl overflow-hidden"
                                                    style={{
                                                        maxHeight: '70vh',
                                                        aspectRatio: `${currentTab.videoWidth} / ${currentTab.videoHeight}`
                                                    }}
                                                >
                                                    <video
                                                        ref={videoRef}
                                                        key={`${currentTab.id}-${posFlow}`}
                                                        autoPlay
                                                        muted
                                                        loop
                                                        playsInline
                                                        className="w-full h-full object-cover"
                                                    >
                                                        <source src={currentFlowData.video} type={currentTab.videoType} />
                                                    </video>
                                                </div>
                                                <p className="text-center text-slate-500 text-sm mt-4">{currentTab.description}</p>
                                            </div>
                                        ) : currentTab.layout === 'portrait' ? (
                                            /* Portrait: iPhone frame */
                                            <div className="relative">
                                                <div className="absolute -inset-4 bg-[#136EF6] rounded-[4rem] blur-2xl opacity-20"></div>
                                                <div className="relative bg-black rounded-[3rem] border-[8px] border-slate-800 shadow-2xl overflow-hidden p-1 w-80 h-[693px]">
                                                    <div className="absolute top-3 left-1/2 -translate-x-1/2 w-24 h-7 bg-black rounded-full z-10"></div>
                                                    <div className="w-full h-full rounded-[2.5rem] overflow-hidden">
                                                        <video
                                                            ref={videoRef}
                                                            key={currentTab.id}
                                                            autoPlay
                                                            muted
                                                            loop
                                                            playsInline
                                                            className="w-full h-full object-cover"
                                                        >
                                                            <source src={currentTab.video} type={currentTab.videoType} />
                                                        </video>
                                                    </div>
                                                </div>
                                            </div>
                                        ) : (
                                            /* Landscape: full-width video */
                                            <div className="relative w-full">
                                                <div className={`absolute -inset-2 bg-gradient-to-r ${currentTab.gradient} rounded-2xl blur-xl opacity-20`}></div>
                                                <div className="relative rounded-xl overflow-hidden border border-white/10 shadow-2xl bg-black">
                                                    <video
                                                        ref={videoRef}
                                                        key={currentTab.id}
                                                        autoPlay
                                                        muted
                                                        loop
                                                        playsInline
                                                        controls
                                                        className="w-full h-auto"
                                                    >
                                                        <source src={currentTab.video} type={currentTab.videoType} />
                                                    </video>
                                                </div>
                                            </div>
                                        )}
                                        {currentTab.layout !== 'dual' && currentTab.layout !== 'device' && (
                                            <p className="text-center text-slate-500 text-sm mt-4">{currentTab.description}</p>
                                        )}
                                    </div>
                                ) : (
                                    /* Placeholder for demos without video */
                                    <div className="flex flex-col items-center justify-center py-20">
                                        <div className="relative">
                                            {/* Glow effect */}
                                            <div className={`absolute -inset-8 bg-gradient-to-r ${currentTab?.gradient} rounded-3xl blur-3xl opacity-10`}></div>

                                            <div className="relative bg-gradient-to-br from-slate-800/80 to-slate-900/80 rounded-2xl border border-white/10 p-12 text-center">
                                                <div className={`w-24 h-24 mx-auto mb-6 rounded-2xl bg-gradient-to-br ${currentTab?.gradient} flex items-center justify-center shadow-xl`}>
                                                    <div className="w-12 h-12 text-white">
                                                        {getIcon(currentTab?.icon)}
                                                    </div>
                                                </div>
                                                <h3 className="text-xl font-bold text-white mb-2">{currentTab?.label} Demo Coming Soon</h3>
                                                <p className="text-slate-400 max-w-md">
                                                    {currentTab?.description}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="flex-shrink-0 border-t border-white/10 bg-black/30 py-4">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <p className="text-center text-slate-500 text-xs">
                                SkyTab Venue Demo Videos
                            </p>
                        </div>
                    </footer>
                </div>
            );
        };

        // --- MAIN APP ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <ErrorBoundary>
                <DemosPage />
            </ErrorBoundary>
        );
    </script>
</body>
</html>
